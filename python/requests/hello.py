# -*- coding: utf-8 -*-
import pprint

import requests

search = {'query': {'bool': {'filter': [{'term': {'storefront_id': 1}},
                               {'term': {'device_type': 1}},
                               {'term': {'day': 20181121}},
                               {'terms': {'app_id': [1038295050,
                                                     933224459,
                                                     1441505295,
                                                     1170987027,
                                                     506363927,
                                                     1088720922,
                                                     1378514979,
                                                     1114716197,
                                                     1157234729,
                                                     1228101675,
                                                     989677611,
                                                     1237481520,
                                                     1090777144,
                                                     1080053818,
                                                     1322330173,
                                                     1241204798,
                                                     1056038975,
                                                     1388310590,
                                                     1213773889,
                                                     986626111,
                                                     1220698181,
                                                     1239308358,
                                                     1015281733,
                                                     1035505740,
                                                     1062221904,
                                                     731697232,
                                                     919902291,
                                                     1129660503,
                                                     1252911192,
                                                     1090349145,
                                                     1437997147,
                                                     824264796,
                                                     1026603103,
                                                     1280215135,
                                                     1051699298,
                                                     1042843755,
                                                     1237559403,
                                                     1347842163,
                                                     1018687608,
                                                     1347684486,
                                                     1323935886,
                                                     1125625999,
                                                     904542352,
                                                     921981073,
                                                     1317660818,
                                                     1394081943,
                                                     1435478173,
                                                     1041653924,
                                                     1126250660,
                                                     1090822309,
                                                     977883304,
                                                     1041680552,
                                                     1031155880,
                                                     1281956013,
                                                     668489901,
                                                     1205416111,
                                                     1089460403,
                                                     1009103031,
                                                     929650874,
                                                     1407205568,
                                                     1258023104,
                                                     1004806337,
                                                     1074172099,
                                                     1210591448,
                                                     512397530,
                                                     972312794,
                                                     515150050,
                                                     1380514027,
                                                     1145532654,
                                                     592031984,
                                                     1177338098,
                                                     1232167156,
                                                     1160139001,
                                                     961296634,
                                                     1124788474,
                                                     842266876,
                                                     1353658626,
                                                     1298411779,
                                                     1187229957,
                                                     1194338569,
                                                     1268898059,
                                                     1338691852,
                                                     1163675921,
                                                     1199255827,
                                                     982098196,
                                                     1315932437,
                                                     1442054420,
                                                     1315997975,
                                                     564713751,
                                                     994470169,
                                                     1396965664,
                                                     1342538025,
                                                     1173416235,
                                                     1079376173,
                                                     1317644591,
                                                     1437479216,
                                                     1340836152,
                                                     1397653817,
                                                     1429459261,
                                                     1155907905,
                                                     941515075,
                                                     1237795144,
                                                     1131942222,
                                                     1391591766,
                                                     1064016216,
                                                     1360206170,
                                                     1172175196,
                                                     1166483806,
                                                     1133072735,
                                                     597772640,
                                                     1003823463,
                                                     1141717352,
                                                     1062222188,
                                                     1257685358,
                                                     1114767733,
                                                     1438972277,
                                                     1241876857,
                                                     1003825530,
                                                     983492987,
                                                     1424015737,
                                                     1401702781,
                                                     1342122366,
                                                     1305756030,
                                                     1433428351,
                                                     967741825,
                                                     1273667966,
                                                     1250392455,
                                                     1070989704,
                                                     1111755153,
                                                     1155453335,
                                                     682264989,
                                                     1434964382,
                                                     975802783,
                                                     948097440,
                                                     1044134302,
                                                     1028346280,
                                                     1373655468,
                                                     1411742130,
                                                     1358621110,
                                                     1175937473,
                                                     417200582,
                                                     1116025300,
                                                     1390526933,
                                                     1166090711,
                                                     1354781143,
                                                     911624664,
                                                     1290783197,
                                                     1373149662,
                                                     591628767,
                                                     1435879907,
                                                     1090824676,
                                                     1126201832,
                                                     1440438760,
                                                     1072302572,
                                                     1153491440,
                                                     942885362,
                                                     1372002804,
                                                     1118935541,
                                                     1128323573,
                                                     1033601528,
                                                     1002355194,
                                                     775817724,
                                                     1077225982,
                                                     719690240,
                                                     1393107456,
                                                     1438831106,
                                                     1313120775,
                                                     1113315848,
                                                     1435857417,
                                                     1040411148,
                                                     897939980,
                                                     958147089,
                                                     1423450653,
                                                     1212690976,
                                                     1055470116,
                                                     1057495590,
                                                     1437596200,
                                                     1164300840,
                                                     468623917,
                                                     975143472,
                                                     847401528,
                                                     1180422715,
                                                     1328280124,
                                                     1354871355,
                                                     1440256572,
                                                     1116027458,
                                                     1057055300,
                                                     1080185416,
                                                     933128780,
                                                     1427280465,
                                                     1071157846,
                                                     1195553366,
                                                     1317503586,
                                                     1000663652,
                                                     1263008364,
                                                     1012300401,
                                                     662721139,
                                                     1404729971,
                                                     1441743478,
                                                     548248183,
                                                     885719675,
                                                     1102002812,
                                                     673880715,
                                                     1170408075,
                                                     659262097,
                                                     1425787538,
                                                     1075819154,
                                                     1188551318,
                                                     1428494998,
                                                     1222275743,
                                                     1019232931,
                                                     1401838245,
                                                     1229562537,
                                                     1195791018,
                                                     1410798250,
                                                     424170160,
                                                     1126734515,
                                                     431809207,
                                                     1246051008,
                                                     439638720,
                                                     1249968838,
                                                     816188106,
                                                     1180865227,
                                                     1299745483,
                                                     1244672717,
                                                     1314134732,
                                                     1071712979,
                                                     1321335511,
                                                     1113926370,
                                                     1017574116,
                                                     1418539752,
                                                     1248162539,
                                                     1314145009,
                                                     1017193205,
                                                     288113403,
                                                     1051276030,
                                                     1326000895,
                                                     1426244353,
                                                     1242757890,
                                                     1401101060,
                                                     1281893127,
                                                     1413645065,
                                                     1079884556,
                                                     400438030,
                                                     1219603220,
                                                     1065704213,
                                                     1118810902,
                                                     1247814425,
                                                     1100083994,
                                                     1030314779,
                                                     1157796637,
                                                     1097476894,
                                                     1239724834,
                                                     1188623144,
                                                     1074610985,
                                                     1383381804,
                                                     1362494257,
                                                     1090831155,
                                                     419261235,
                                                     718101314,
                                                     1324380995,
                                                     1276474178,
                                                     1155058500,
                                                     1131940677,
                                                     1244019527,
                                                     1163985736,
                                                     1121520457,
                                                     983104325,
                                                     1421046597,
                                                     1163578189,
                                                     1233050449,
                                                     1336802130,
                                                     1434022740,
                                                     1373188953,
                                                     1068094297,
                                                     1345446749,
                                                     1127254878,
                                                     873925474,
                                                     1403669348,
                                                     1442200421,
                                                     1438376806,
                                                     1059165037,
                                                     1184848750,
                                                     923306863,
                                                     1091169138,
                                                     1237447549,
                                                     1180474242,
                                                     821470084,
                                                     1436558216,
                                                     1218218891,
                                                     1073861519,
                                                     1237447570,
                                                     1160678296,
                                                     1044149145,
                                                     1144865690,
                                                     1187066779,
                                                     1137431453,
                                                     1163139998,
                                                     1187546017,
                                                     1313145775,
                                                     1137394607,
                                                     1342524339,
                                                     1223938995,
                                                     807551930,
                                                     1167952831,
                                                     998790080,
                                                     1013601215,
                                                     1100262340,
                                                     1071496139,
                                                     1172650959,
                                                     1093706705,
                                                     1125233620,
                                                     1205410780,
                                                     1149672415,
                                                     1364837343,
                                                     1269466082,
                                                     1316879331,
                                                     1329681380,
                                                     1369938914,
                                                     1180462051,
                                                     1202594791,
                                                     1269408744,
                                                     997235687,
                                                     1072141290,
                                                     1362361330,
                                                     1316322292,
                                                     1011756026,
                                                     1086252028,
                                                     1070459902,
                                                     1414857731,
                                                     1382536196,
                                                     1070824453,
                                                     1315914758,
                                                     1028963337,
                                                     1025625100,
                                                     689859603,
                                                     918137885,
                                                     358347809,
                                                     837917731,
                                                     1190446116,
                                                     913513510,
                                                     1137968171,
                                                     1388274732,
                                                     1100129325,
                                                     1091497003,
                                                     1078076468,
                                                     1320700981,
                                                     1198419002,
                                                     1003680829,
                                                     1093850181,
                                                     1194988627,
                                                     1068366937,
                                                     1372796000,
                                                     927226988,
                                                     964725870,
                                                     1188918383,
                                                     1372685428,
                                                     903246967,
                                                     1057868919,
                                                     1225499773,
                                                     1435999358,
                                                     962286723,
                                                     911686788,
                                                     917218439,
                                                     664960136,
                                                     822613136,
                                                     1164027025,
                                                     1278362772,
                                                     1379914902,
                                                     1021592731,
                                                     999224477,
                                                     1049621666,
                                                     941477027,
                                                     1008055461,
                                                     1378800805,
                                                     1231346854,
                                                     550069430,
                                                     1208081593,
                                                     1339010237,
                                                     1105745087,
                                                     1139674303,
                                                     914250948,
                                                     1234189511,
                                                     1111055564,
                                                     1066810573,
                                                     557081812,
                                                     1073044696,
                                                     1279718634,
                                                     1227576560,
                                                     525692157,
                                                     1151114495,
                                                     1372837123,
                                                     951627022,
                                                     1091951888,
                                                     1208341780,
                                                     1404681493,
                                                     1419986199,
                                                     1357518107,
                                                     1218125083,
                                                     1209314595,
                                                     947688742,
                                                     598539558,
                                                     1142158631,
                                                     734412073,
                                                     1404845354,
                                                     948620592,
                                                     1276157234,
                                                     1167404344,
                                                     1298382136,
                                                     910038330,
                                                     1367041348,
                                                     1409078597,
                                                     1259816262,
                                                     1342995786,
                                                     1334017357,
                                                     1299590483,
                                                     1337556312,
                                                     1301478746,
                                                     866782555,
                                                     1210248543,
                                                     997586276,
                                                     1257377126,
                                                     908623207,
                                                     829465961,
                                                     1438702966,
                                                     1137018231,
                                                     1148372342,
                                                     1353684346,
                                                     945386876,
                                                     1183202691,
                                                     1424051588,
                                                     1144376708,
                                                     1417811337,
                                                     440948110,
                                                     1246633362,
                                                     1363840409,
                                                     919854496,
                                                     1440705955,
                                                     1135398319,
                                                     1375481264,
                                                     899505583,
                                                     1267193275,
                                                     1098628542,
                                                     1229317577,
                                                     1131941329,
                                                     930368978,
                                                     1131941339,
                                                     1440706019,
                                                     1123438054,
                                                     840060392,
                                                     1087897068,
                                                     1294601709,
                                                     1146424816,
                                                     1015772660,
                                                     1439903221,
                                                     1260903925,
                                                     1324471801,
                                                     1336432123,
                                                     1374307839,
                                                     1326038529,
                                                     1296137737,
                                                     1421565452,
                                                     1182213646,
                                                     1261766158,
                                                     1322950158,
                                                     1131974158,
                                                     1229037076,
                                                     502271511,
                                                     1367359000,
                                                     1276159513,
                                                     1037700632,
                                                     1171316251,
                                                     1377121820,
                                                     1073018397,
                                                     1305617944,
                                                     1143369250,
                                                     1305675299,
                                                     1314139684,
                                                     525348387,
                                                     1246637618,
                                                     1101000245,
                                                     1113452093,
                                                     1369839166,
                                                     1406238274,
                                                     990508615,
                                                     1188613704,
                                                     933160533,
                                                     1387781723,
                                                     824204893,
                                                     1185396322,
                                                     1054324329,
                                                     462149227,
                                                     627857009,
                                                     1381013108,
                                                     1382665847,
                                                     924485242,
                                                     1180903035,
                                                     983471742,
                                                     1063183999,
                                                     404522625,
                                                     1264952968,
                                                     1338707595,
                                                     1112069772,
                                                     871659147,
                                                     1210334862,
                                                     1223468683,
                                                     995952272,
                                                     1159364240,
                                                     1129658002,
                                                     1272458898,
                                                     1182277270,
                                                     1381312150,
                                                     1103083161,
                                                     1165315739,
                                                     730904222,
                                                     539211425,
                                                     905871009,
                                                     1330124451,
                                                     1260431012,
                                                     965095074,
                                                     1191177889,
                                                     1269300903,
                                                     989071018,
                                                     1126731437,
                                                     1086656174,
                                                     542308019,
                                                     1239594679,
                                                     1194004153,
                                                     1336342202,
                                                     1123536575,
                                                     969774786,
                                                     1330564804,
                                                     1303439045,
                                                     1080133318,
                                                     778424007,
                                                     1139996359,
                                                     1167824599,
                                                     740146917,
                                                     1220271849,
                                                     1061461739,
                                                     1372638959,
                                                     1290600176,
                                                     615196408,
                                                     1423245053,
                                                     1413715728,
                                                     1073862417,
                                                     500967185,
                                                     1346144017,
                                                     424560403,
                                                     579825429,
                                                     1155901206,
                                                     1118969623,
                                                     804658968,
                                                     1208039195,
                                                     1247715101,
                                                     1168518943,
                                                     604757792,
                                                     796440356,
                                                     878704422,
                                                     1383620391,
                                                     1210543916,
                                                     1314832178,
                                                     1404194614,
                                                     1019516728,
                                                     1388818232,
                                                     1139091258,
                                                     1090344761,
                                                     792633152,
                                                     1081132864,
                                                     1216495426,
                                                     980168512,
                                                     1196638020,
                                                     1050249032,
                                                     1058217807,
                                                     569778005,
                                                     972330844,
                                                     1205278557,
                                                     1432274786,
                                                     1230792548,
                                                     724295527,
                                                     824786793,
                                                     1276440426,
                                                     1093201773,
                                                     940982126,
                                                     976916334,
                                                     1224181621,
                                                     1300524919,
                                                     1316867960,
                                                     1059622777,
                                                     788406144,
                                                     1440771972,
                                                     1382150036,
                                                     1203695509,
                                                     918861721,
                                                     1375893406,
                                                     1232131998,
                                                     627390368,
                                                     1397718945,
                                                     449822627,
                                                     1267206052,
                                                     1066237859,
                                                     1244411812,
                                                     1193119654,
                                                     1054818220,
                                                     696965038,
                                                     1150398390,
                                                     1414834103,
                                                     1052501951,
                                                     1439115200,
                                                     1116022721,
                                                     952047557,
                                                     1268541383,
                                                     1435854798,
                                                     784297935,
                                                     1332432851,
                                                     1139101653,
                                                     1042182109,
                                                     809318366,
                                                     1330376669,
                                                     1237452767,
                                                     1035069411,
                                                     1417048036,
                                                     1135785970,
                                                     1128765433,
                                                     1338650621]}}]}},
          'size': 12500}

_ = search['query']['bool']['filter'][3]['terms']['app_id']
pprint.pprint(len(_))

url = 'http://n1472.ops.gaoshou.me:9200/app_rank_daily_201811/app_rank/_search'

resp = requests.post(url, json=search)
pprint.pprint(resp.status_code)
pprint.pprint(resp.json())
